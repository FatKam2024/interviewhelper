<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Prep Master</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
            margin-bottom: 10px;
        }
        .timer {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .search-container {
            display: flex;
            flex-grow: 1;
            margin-right: 10px;
        }
        #searchInput {
            flex-grow: 1;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px 0 0 4px;
            height: 40px;
            box-sizing: border-box;
        }
        .controls {
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            transition: background-color 0.3s;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        button:hover {
            background-color: #45a049;
        }
        #searchButton {
            border-radius: 0 4px 4px 0;
        }
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        select {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .question-item, .story-item {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .question-item h3, .story-item h3 {
            margin-top: 0;
            cursor: pointer;
        }
        .question-details, .answer, .story-content {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background-color: #e9e9e9;
            border-radius: 4px;
        }
        .dark-mode {
            background-color: #333;
            color: #fff;
        }
        .dark-mode .question-item, .dark-mode .story-item {
            background-color: #444;
            border-color: #555;
        }
        .dark-mode .question-details, .dark-mode .answer, .dark-mode .story-content {
            background-color: #555;
        }
        .tab-container {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background-color: #ddd;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
        }
        .tab.active {
            background-color: #f9f9f9;
        }
        .content {
            display: none;
        }
        .content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .top-bar {
                flex-direction: column;
                align-items: stretch;
            }
            .search-container {
                margin-right: 0;
                margin-bottom: 10px;
            }
            .controls {
                justify-content: space-between;
            }
            .filters {
                flex-direction: column;
            }
            select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Interview Prep Master</h1>
        <div id="timer" class="timer">00:00:00</div>
        
        <div class="tab-container">
            <div class="tab active" data-tab="questions">Interview Questions</div>
            <div class="tab" data-tab="stories">Personal Stories</div>
        </div>

        <div id="questionsContent" class="content active">
            <div class="top-bar">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search questions...">
                    <button id="searchButton">Search</button>
					<button id="resetBtn">Reset</button>
                </div>
                <div class="controls">
                    <button id="filterBtn">Filters</button>
                    <button id="randomBtn">Random</button>
                    <button id="darkModeBtn">Dark Mode</button>
                </div>
            </div>

            <div id="filters" class="filters" style="display: none;">
                <select id="categoryFilter">
                    <option value="">All Categories</option>
                </select>
                <select id="typeFilter">
                    <option value="">All Types</option>
                </select>
                <select id="jobFilter">
                    <option value="">All Jobs</option>
                </select>
            </div>

            <div id="questionList"></div>
        </div>

        <div id="storiesContent" class="content">
            <div id="personalStories"></div>
        </div>
    </div>

    <script>
        let questions = [];
        let stories = [];
        let darkMode = false;

        $(document).ready(function() {
            fetchQuestions();
            fetchStories();
            startTimer();

            $('#searchInput').on('keyup', function(e) {
                if (e.key === 'Enter') {
                    filterQuestions();
                }
            });
            $('#searchButton').on('click', filterQuestions);
            $('#filterBtn').on('click', toggleFilters);
            $('#randomBtn').on('click', showRandomQuestions);
            $('#darkModeBtn').on('click', toggleDarkMode);

            $('.filters select').on('change', filterQuestions);

            $('.tab').on('click', function() {
                $('.tab').removeClass('active');
                $(this).addClass('active');
                $('.content').removeClass('active');
                $('#' + $(this).data('tab') + 'Content').addClass('active');
            });

            $(document).on('click', '.question-item h3', function() {
                $(this).siblings('.question-details, .answer').slideToggle();
            });

            $(document).on('click', '.story-item h3', function() {
                $(this).siblings('.story-content').slideToggle();
            });
        });

        async function fetchQuestions() {
            try {
                const response = await fetch('questions.json');
                questions = await response.json();
                populateFilters();
                displayQuestions(questions);
            } catch (error) {
                console.error('Error fetching questions:', error);
            }
        }

        async function fetchStories() {
            try {
                const response = await fetch('stories.json');
                stories = await response.json();
                displayStories();
            } catch (error) {
                console.error('Error fetching stories:', error);
            }
        }

        function populateFilters() {
            const categories = new Set();
            const types = new Set();
            const jobs = new Set();

            questions.forEach(question => {
                categories.add(question.category);
                types.add(question.type);
                jobs.add(question.relevantJob);
            });

            populateSelect('categoryFilter', categories);
            populateSelect('typeFilter', types);
            populateSelect('jobFilter', jobs);
        }

        function populateSelect(id, options) {
            const select = $('#' + id);
            options.forEach(option => {
                select.append($('<option>').val(option).text(option));
            });
        }

        function displayQuestions(questionsToDisplay) {
            const questionList = $('#questionList');
            questionList.empty();

            questionsToDisplay.forEach(question => {
                const questionItem = $('<div>').addClass('question-item');
                questionItem.html(`
                    <h3>${question.question}</h3>
                    <div class="question-details">
                        <p>Category: ${question.category}</p>
                        <p>Type: ${question.type}</p>
                        <p>Relevant Job: ${question.relevantJob}</p>
                    </div>
                    <div class="answer">
                        <h4>English Answer:</h4>
                        <p>${question.answers.openai.english || question.answers.claude.english || 'No answer available'}</p>
                        <h4>Cantonese Answer:</h4>
                        <p>${question.answers.openai.cantonese || question.answers.claude.cantonese || 'No answer available'}</p>
                    </div>
                `);
                questionList.append(questionItem);
            });
        }

        function filterQuestions() {
            const searchTerm = $('#searchInput').val().toLowerCase();
            const category = $('#categoryFilter').val();
            const type = $('#typeFilter').val();
            const job = $('#jobFilter').val();
            const language = $('#languageFilter').val();
            const source = $('#sourceFilter').val();

            const filteredQuestions = questions.filter(question => {
                const matchesSearch = question.question.toLowerCase().includes(searchTerm);
                const matchesCategory = category === '' || question.category === category;
                const matchesType = type === '' || question.type === type;
                const matchesJob = job === '' || question.relevantJob === job;
                const matchesLanguage = language === '' || (language === 'english' && (question.answers.openai.english || question.answers.claude.english)) || (language === 'cantonese' && (question.answers.openai.cantonese || question.answers.claude.cantonese));
                const matchesSource = source === '' || (source === 'Human' && question.answers.human) || (source === 'OpenAI' && question.answers.openai) || (source === 'Claude' && question.answers.claude);

                return matchesSearch && matchesCategory && matchesType && matchesJob && matchesLanguage && matchesSource;
            });

            displayQuestions(filteredQuestions);
        }

        function toggleFilters() {
            $('#filters').slideToggle();
        }

        function showRandomQuestions() {
            const numQuestions = 5;
            const randomQuestions = [];
            const questionsCopy = [...questions];

            for (let i = 0; i < numQuestions && questionsCopy.length > 0; i++) {
                const randomIndex = Math.floor(Math.random() * questionsCopy.length);
                randomQuestions.push(questionsCopy.splice(randomIndex, 1)[0]);
            }

            displayQuestions(randomQuestions);
        }

        function toggleDarkMode() {
            darkMode = !darkMode;
            $('body').toggleClass('dark-mode', darkMode);
        }

        function displayStories() {
            const personalStories = $('#personalStories');
            personalStories.empty();

            stories.forEach(story => {
                const storyItem = $('<div>').addClass('story-item');
                storyItem.html(`
                    <h3>${story.title}</h3>
                    <div class="story-content">
                        <p><strong>Situation:</strong> ${story.situation}</p>
                        <p><strong>Story:</strong> ${story.story}</p>
                    </div>
                `);
                personalStories.append(storyItem);
            });
        }

        function startTimer() {
            let seconds = 0;

            setInterval(() => {
                seconds++;
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const remainingSeconds = seconds % 60;

                $('#timer').text(`${pad(hours)}:${pad(minutes)}:${pad(remainingSeconds)}`);
            }, 1000);
        }

        function pad(number) {
            return number.toString().padStart(2, '0');
        }
    </script>
</body>
</html>
